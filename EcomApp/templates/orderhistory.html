{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Order History | ShopNow</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-slate-50 to-slate-200 text-slate-800 min-h-screen">

<!-- ================= NAVBAR ================= -->
<header class="sticky top-0 z-50">

  <nav class="backdrop-blur-xl
              bg-gradient-to-r from-[#020617] via-[#0f172a] to-[#020617]
              border-b border-white/10
              shadow-[0_10px_30px_rgba(2,6,23,0.6)]">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">

      <!-- Logo -->
      <div class="text-2xl font-black tracking-wide
                  text-white drop-shadow-[0_2px_6px_rgba(255,255,255,0.25)]">
        ğŸ›’ ShopNow
      </div>

      <!-- Hamburger -->
      <button id="menuBtn"
              class="lg:hidden text-white text-2xl focus:outline-none">
        â˜°
      </button>

      <!-- Desktop Menu -->
      <ul class="hidden lg:flex gap-8 items-center font-medium text-slate-200">
        <li class="nav-item"><a href="/">Home</a></li>

        {% for item in categories %}
        <li class="nav-item">
          <a href="{% url 'storeproductscategory' item.name %}">
            {{ item.name }}
          </a>
        </li>
        {% endfor %}

        {% if username %}
          <li class="opacity-80">Hi, {{ username }}</li>

          <li>
            <a href="{% url 'displaycart' %}"
               class="flex items-center justify-center w-10 h-10 rounded-full
                      bg-white text-slate-900 border border-slate-700/40 shadow">
              ğŸ›’
            </a>
          </li>

          <li class="btn">
            <a href="{% url 'storelogout' %}">Logout</a>
          </li>
        {% else %}
          <li class="btn">
            <a href="{% url 'storelogin' %}">Login</a>
          </li>
        {% endif %}
      </ul>

    </div>
  </nav>

  <!-- ================= MOBILE MENU ================= -->
  <div id="mobileMenu"
       class="lg:hidden hidden
              bg-gradient-to-b from-[#020617] to-[#0f172a]
              border-b border-white/10
              shadow-xl">

    <ul class="flex flex-col px-6 py-6 gap-4 text-slate-200 font-medium">
      <li><a href="/" class="block py-2">Home</a></li>

      {% for item in categories %}
      <li>
        <a href="{% url 'storeproductscategory' item.name %}"
           class="block py-2">
          {{ item.name }}
        </a>
      </li>
      {% endfor %}

      {% if username %}
        <li class="pt-3 border-t border-white/10 opacity-80">
          Hi, {{ username }}
        </li>
        <li><a href="{% url 'displaycart' %}" class="block py-2">ğŸ›’ Cart</a></li>
        <li>
          <a href="{% url 'storelogout' %}"
             class="block py-2 text-red-400">Logout</a>
        </li>
      {% else %}
        <li><a href="{% url 'storelogin' %}" class="block py-2">Login</a></li>
      {% endif %}
    </ul>
  </div>

</header>

<!-- ================= PAGE HEADER ================= -->
<section class="py-14 text-center">
  <h1 class="text-4xl font-extrabold text-slate-900">
    ğŸ“¦ Your Orders
  </h1>
  <p class="text-slate-500 mt-2">
    Track and manage your purchases
  </p>
  <div class="w-28 h-1 bg-slate-900 mx-auto mt-4 rounded-full"></div>
</section>

<!-- ================= ORDERS ================= -->
<main class="max-w-6xl mx-auto px-6 pb-20 space-y-8">

{% if orders %}
{% for order in orders %}

<div class="bg-white rounded-[28px]
            shadow-[0_20px_40px_rgba(15,23,42,0.15)]
            hover:shadow-[0_30px_60px_rgba(15,23,42,0.25)]
            transition-all duration-500
            flex flex-col md:flex-row gap-6 p-6">

  <!-- Image -->
  <div class="w-32 h-32 shrink-0 overflow-hidden rounded-xl border">
    <img src="{{ order.product.image.url }}"
         alt="{{ order.product.name }}"
         class="w-full h-full object-cover hover:scale-110 transition">
  </div>

  <!-- Details -->
  <div class="flex-1">
    <h2 class="text-lg font-semibold text-slate-900 mb-1">
      {{ order.product.name }}
    </h2>

    <p class="text-sm text-slate-500 mb-3">
      {{ order.product.category }}
    </p>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-y-2 text-sm text-slate-600">
      <p><span class="font-medium">Order ID:</span> #{{ order.id }}</p>
      <p><span class="font-medium">Date:</span> {{ order.orderdate }}</p>

      <p>
        <span class="font-medium">Status:</span>
        <span class="px-2 py-0.5 rounded-full text-xs font-semibold
          {% if order.orderstatus == 'Delivered' %}
            bg-green-100 text-green-700
          {% elif order.orderstatus == 'Cancelled' %}
            bg-red-100 text-red-700
          {% else %}
            bg-yellow-100 text-yellow-700
          {% endif %}
        ">
          {{ order.orderstatus }}
        </span>
      </p>

      <p><span class="font-medium">Payment:</span> {{ order.paymentmethod }}</p>

      <p class="sm:col-span-2">
        <span class="font-medium">Address:</span> {{ order.address }}
      </p>
    </div>

    <p class="mt-4 text-xl font-extrabold
              bg-gradient-to-r from-slate-900 to-slate-700
              bg-clip-text text-transparent">
      â‚¹ {{ order.product.price }}
    </p>
  </div>

  <!-- Action -->
  <div class="flex items-center">
    <a href="{% url 'cancelorder' order.id %}"
       class="px-6 py-2 rounded-xl bg-red-600 text-white
              shadow hover:bg-red-700 transition">
      âŒ Cancel
    </a>
  </div>

</div>

{% endfor %}
{% else %}

<!-- EMPTY STATE -->
<div class="bg-white rounded-[28px]
            shadow-[0_20px_40px_rgba(15,23,42,0.15)]
            p-16 text-center">
  <p class="text-4xl mb-4">ğŸ“¦</p>
  <h2 class="text-xl font-semibold text-slate-700 mb-2">
    No Orders Found
  </h2>
  <p class="text-slate-500 mb-6">
    You havenâ€™t placed any orders yet.
  </p>
  <a href="/"
     class="inline-block px-8 py-3 rounded-xl
            bg-gradient-to-r from-slate-800 to-slate-700
            text-white font-semibold shadow hover:shadow-lg transition">
    Start Shopping
  </a>
</div>

{% endif %}

</main>

<!-- ================= STYLES ================= -->
<style>
  .nav-item {
    position: relative;
    cursor: pointer;
  }
  .nav-item::after {
    content: "";
    position: absolute;
    width: 0;
    height: 2px;
    background: linear-gradient(to right, #38bdf8, #2563eb);
    left: 0;
    bottom: -5px;
    transition: 0.3s;
  }
  .nav-item:hover::after {
    width: 100%;
  }

  .btn {
    background: white;
    padding: 6px 16px;
    border-radius: 9999px;
    color: #020617;
    font-weight: 600;
    border: 1px solid rgba(15,23,42,0.35);
    box-shadow:
      0 4px 10px rgba(0,0,0,0.25),
      inset 0 1px 0 rgba(255,255,255,0.6);
  }
</style>

<!-- ================= JS ================= -->
<script>
  const menuBtn = document.getElementById("menuBtn");
  const mobileMenu = document.getElementById("mobileMenu");

  menuBtn.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
  });

  window.addEventListener("resize", () => {
    if (window.innerWidth >= 1024) {
      mobileMenu.classList.add("hidden");
    }
  });

  document.querySelectorAll("#mobileMenu a").forEach(link => {
    link.addEventListener("click", () => {
      mobileMenu.classList.add("hidden");
    });
  });
</script>

</body>
</html>
